g
<odoo>
  <data>
    <record model="ir.ui.view" id="ci_app_adi.list">
      <field name="name">ci_app_adi list</field>
      <field name="model">ci_app_adi.ci_app_adi</field>
      <field name="arch" type="xml">
        <tree>
	  <field name="action_reference"/>
          <field name="title"/>
          <field name="status"/>
        </tree>
      </field>
    </record>

    <record model="res.groups" id="ci_app_adi.group_ci_admin">
      <field name="name">CI Admin</field>
    </record>
    
    <record model="res.groups" id="ci_app_adi.group_ci_user">
      <field name="name">CI User</field>
    </record>

    <record model="ir.ui.view" id="ci_app_adi.form">
      <field name="name">ci_app_adi form</field>
      <field name="model">ci_app_adi.ci_app_adi</field>
      <field name="type">form</field>
      <field name="arch" type="xml">
	<form>
	  <header>
	    <field name="previous_status" invisible="1"/>
	    <button attrs="{'invisible': [('status', '!=', 'Open')]}" type="object" name="button_set_in_progress" string="Advance"/>
	    <button attrs="{'invisible': [('status', '!=', 'In Progress')]}" type="object" name="button_set_awaiting_verification" string="Complete"/>
	    <button attrs="{'invisible': [('status', '!=', 'Awaiting Verification')]}" type="object" name="button_set_done" string="Verify" groups="ci_app_adi.group_ci_admin"/>
	    <button type="object" attrs="{'invisible': [('status', 'in', ['Open', 'On Hold', 'Done'])]}" name="button_revert" string="Revert"/>
	    <button type="object" attrs="{'invisible': [('status', '!=', 'Done')]}" name="button_revert" string="Revert" groups="ci_app_adi.group_ci_admin"/>
	    <h1 attrs="{'invisible': ['|', ('previous_status', '==', False), ('status', '!=', 'On Hold')]}">
	      On Hold
	    </h1>

	    <button type="object" attrs="{'invisible': ['|', ('previous_status', '==', False), ('status', '!=', 'On Hold')]}" name="button_undo" string="Resume"/>
	    <button type="object" attrs="{'invisible': [('status', '==', 'On Hold')]}" name="button_set_on_hold" string="Put on hold"/>
	    <button type="object" name="button_print_report" string="Print"/>
	    <field attrs="{'invisible': [('status', '==', 'On Hold')]}" name="status" widget="statusbar" statusbar_visible="Open,In Progress,Awaiting Verification,Done"/>
	  </header>
	  <sheet>
	    <h1>
	      <field name="title" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	    </h1>
	    <group attrs="{'invisible': ['|', ('action_type', '==', 'CI'), ('action_type', '==', 'CAR')]}">
	      <field name="action_type" label="Type" style="width:100px;"/>
	    </group>
	    <group class="row" attrs="{'invisible': [('action_type', '!=', 'CI')]}">
	      <group>
		<field name="id" invisible="1"/>
		<field name="title" attrs="{'invisible': [('id', '!=', False)]}"/>
		<field name="date_opened" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="opened_by" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="process_area" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="priority" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="date_due" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      </group>
	      <group>
		<field name="owner" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="date_done" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="verified_by" attrs="{'invisible': [('status', '!=', 'Done')]}"/>
	      </group>
	    </group>
	    <group attrs="{'invisible': [('action_type', '!=', 'CI')]}">
	      <field name="summary" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="notes" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="verification_notes" widget="Html" attrs="{'invisible':[('status', '!=', 'Awaiting Verification')]}" groups="ci_app_adi.group_ci_admin"/>
	      <field name="verification_notes" widget="Html" attrs="{'invisible': [('status', '!=', 'Done')], 'readonly': [('status', '==', 'Done')]}"/>
	    </group>
	    <group attrs="{'invisible': [('action_type', '!=', 'CAR')]}">
	      <group>
		<field name="id" invisible="1"/>
		<field name="title" attrs="{'invisible': [('id', '!=', False)]}"/>
		<field name="date_opened" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="opened_by" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="process_area" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="risk" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      </group>
	      <group>
		<field name="related_so" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="related_so_customer" attrs="{'invisible': [('related_so', '==', None)]}"/>
		<field name="related_so_description" attrs="{'invisible': [('related_so', '==', None)]}"/>  
		<field name="owner" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="date_due" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="date_done" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="date_closed" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
		<field name="verified_by" attrs="{'invisible': [('status', '!=', 'Done')]}"/>
	      </group>
	    </group>
	    <group attrs="{'invisible': [('action_type', '!=', 'CAR')]}">
	      <field name="summary" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="containment" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="cause" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="notes" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="actions" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="future_improvements" widget="Html" attrs="{'readonly': ['|', ('status', '==', 'Awaiting Verification'), ('status', '==', 'Done')]}"/>
	      <field name="verification_notes" widget="Html" attrs="{'invisible':[('status', '!=', 'Awaiting Verification')]}" groups="ci_app_adi.group_ci_admin"/>
	      <field name="verification_notes" widget="Html" attrs="{'invisible': [('status', '!=', 'Done')], 'readonly': [('status', '==', 'Done')]}"/>
	    </group>
	  </sheet>
	  <div class="oe_chatter">
	    <field name="message_follower_ids"/>
	    <field name="message_ids"/>
	  </div>
	</form>
      </field>
    </record>

    <record model="ir.actions.act_window" id="ci_app_adi.action_window_ci">
      <field name="name">CI View</field>
      <field name="res_model">ci_app_adi.ci_app_adi</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('action_type', '=', 'CI')]</field>
    </record>

    <record model="ir.actions.act_window" id="ci_app_adi.action_window_car">
      <field name="name">CAR View</field>
      <field name="res_model">ci_app_adi.ci_app_adi</field>
      <field name="view_mode">tree,form</field>
      <field name="domain">[('action_type', '=', 'CAR')]</field>
    </record>

    <record model="ir.actions.server" id="ci_app_adi.action_server">
      <field name="name">ci_app_adi server</field>
      <field name="model_id" ref="model_ci_app_adi_ci_app_adi"/>
      <field name="state">code</field>
      <field name="code">
	action = {
	"type": "ir.actions.act_window",
	"view_mode": "tree,form",
	"res_model": model._name,
	}
      </field>
    </record>

    <menuitem name="Improvements App" id="ci_app_adi.menu_root"/>
    <!--
	<menuitem name="New CAR" id="ci_app_adi.menu_new_car"
	parent="ci_app_adi.menu_root" action="ci_app_adi.new_car_server"/>
	<menuitem name="New CI" id="ci_app_adi.menu_new_ci"
	parent="ci_app_adi.menu_root" action="ci_app_adi.new_car_server"/>
    -->
    <menuitem name="CI List" id="ci_app_adi.menu_ci_list" parent="ci_app_adi.menu_root" action="ci_app_adi.action_window_ci"/>

    <menuitem name="CAR List" id="ci_app_adi.menu_car_list" parent="ci_app_adi.menu_root" action="ci_app_adi.action_window_car"/>
</data>
</odoo>
